<!DOCTYPE html>
<html xmlns:layout="http://www.w3.org/1999/xhtml"
	layout:decorate="~{etc/fragments/Main_layout}">
<head>
<title>지점 상세 정보</title>
<meta charset="utf-8">
<meta id="_csrf" name="_csrf" th:content="${_csrf.token}" />
<!-- default header name is X-CSRF-TOKEN -->
<meta id="_csrf_header" name="_csrf_header"
	th:content="${_csrf.headerName}" />
<script
	src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<style>

#houseInfo{
	font-family: 'Jua', sans-serif;
}

body {
	padding-top: 114px;
	font-family: 'Jua', sans-serif;
	
}

body, input, textarea, select, button, table {
    font-family: 돋움, Dotum, 맑은고딕, "malgun gothic", "Apple SD Gothic Neo", Helvetica, sans-serif;
    font-size: 14px;
}

#navbar {
	overflow: hidden;
	background-color: #2eca6a;
}

#navbar1 {
	overflow: hidden;
	background-color: #2eca6a;
	width: 225px;
}

#navbar a {
	float: left;
	display: block;
	color: #f2f2f2;
	text-align: center;
	padding: 14px 16px;
	text-decoration: none;
	font-size: 17px;
}

#navbar a:hover {
	background-color: #ddd;
	color: black;
}

#navbar a.active {
	background-color: #4CAF50;
	color: white;
}

.sticky {
	position: fixed;
	top: 92.18px;
	/* width: 100%; */
	width: 1015px;
	z-index: 2;
}

.sticky1 {
	position: fixed;
	top: 92.18px;
	/* width: 100%; */
	width: 200px;
	z-index: 2;
}

.sticky+.content {
	padding-top: 60px;
}

.fixed {
	position: fixed;
	border-radius: 25px;
	color: #f2f2f2;
	text-align: center;
	bottom: 800;
	right: 20px;
	width: 180px;
	height: 150px;
	background-color: #2eca6a;
}

/* The Modal (background) */
.modal {
	display: none; /* Hidden by default */
	position: fixed; /* Stay in place */
	z-index: 3; /* Sit on top */
	padding-top: 100px; /* Location of the box */
	left: 0;
	top: 0;
	width: 100%; /* Full width */
	height: 100%; /* Full height */
	overflow: auto; /* Enable scroll if needed */
	background-color: rgb(0, 0, 0); /* Fallback color */
	background-color: rgba(0, 0, 0, 0.4); /* Black w/ opacity */
}

/* Modal Content */
.modal-content {
	background-color: #fefefe;
	margin: auto;
	padding: 20px;
	border: 1px solid #888;
	width: 50%;
	border-top-width: 0px;
}

/* The Close Button */
.close {
	color: #aaaaaa;
	float: right;
	font-size: 28px;
	font-weight: bold;
}

.close:hover, .close:focus {
	color: #000;
	text-decoration: none;
	cursor: pointer;
}

/* * {
  box-sizing: border-box;
}

img {
  vertical-align: middle;
}

/* Position the image container (needed to position the left and right arrows) */
.container {
	position: relative;
}

/* Hide the images by default */
.mySlides {
	display: none;
}

/* Add a pointer when hovering over the thumbnail images */
.cursor {
	cursor: pointer;
}

/* Next & previous buttons */
.prev, .next {
	cursor: pointer;
	position: absolute;
	top: 40%;
	width: auto;
	padding: 16px;
	margin-top: -50px;
	color: white;
	font-weight: bold;
	font-size: 20px;
	border-radius: 0 3px 3px 0;
	user-select: none;
	-webkit-user-select: none;
}

/* Position the "next button" to the right */
.next {
	right: 0;
	border-radius: 3px 0 0 3px;
}

/* On hover, add a black background color with a little bit see-through */
.prev:hover, .next:hover {
	background-color: rgba(0, 0, 0, 0.8);
}

/* Number text (1/3 etc) */
.numbertext {
	color: #f2f2f2;
	font-size: 12px;
	padding: 8px 12px;
	position: absolute;
	top: 0;
}

/* Container for image text */
.caption-container {
	text-align: center;
	background-color: #222;
	padding: 2px 16px;
	color: white;
}

.row:after {
	content: "";
	display: table;
	clear: both;
}

/* Six columns side by side */
.column {
	float: left;
	width: 16.66%;
}

/* Add a transparency effect for thumnbail images */
.demo {
	opacity: 0.6;
}

.active, .demo:hover {
	opacity: 1;
}

#myBtn {
	padding: 2px;
}

#myBtn1 {
	padding: 2px;
}

.uploadResult ul li{
list-style: none;
padding: 10px;
}

.uploadResult ul li img{
width:300px;
}

#carouselExampleControls{
width: 850px;
}


</style>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">	
</head>
<body id='houseInfo'>


	<div layout:fragment="content" class="container" xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4" >

		<br /> <br /> <br />

		<h1 style="float: left">낙낙 쉐어 하우스 &nbsp;</h1>
		<h1 th:text="${details.branchNumber}" id='branchNumber'
			style="float: left"></h1>
		<h1 style="float: left">호점</h1>
		<!-- <div th:text="${details.branchNumber}" id='branchNameTest'></div> -->

		<br /> <br /> <br /> <br /> <br /> <br />
		
		<div id="carouselExampleControls" class="carousel slide" data-ride="carousel">
  			<div class="carousel-inner">
  			
		    <div class="carousel-item active">
		      <img class="d-block w-100" th:src="'/images/branch/'+${details.branchNumber}+'branch.jpg'" alt="First slide">
		    </div>
		    
		  </div>
		  <a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-slide="prev">
		    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
		    <span class="sr-only">Previous</span>
		  </a>
		  <a class="carousel-control-next" href="#carouselExampleControls" role="button" data-slide="next">
		    <span class="carousel-control-next-icon" aria-hidden="true"></span>
		    <span class="sr-only">Next</span>
		  </a>
		</div>
		
		<br /> <br /> <br /> 

		<div class="row">
			<div class="col-md-11">

				<div id="myModal" class="modal">
					<div class="modal-content">
						<form action="/visitBooking" method="post" id="visitBookingForm">
							<span class="close">&times;</span>
							<h3 style="float: left">낙낙&nbsp;</h3>
							<h3 th:text="${details.branchNumber}" 
								style="float: left"></h3>
							<h3 style="float: left">호점 방문 신청</h3>
							<input type="hidden" name="branchNumber"
								th:value="${details.branchNumber}">
							<p>방문을 원하는 날짜와 시간을 선택해주세요</p>
							<input type="date" name="reservationTime" /> <input type="text"
								class="form-control" name="memo" placeholder="간단한 메모를 남겨주세요." />
							<p>방문 신청 후 3일 이내 해당 지점 매니저가 확인 연락을 드립니다.</p>
							<div class="row">
								<div class="col-md-6">
									<button type="button" class="btn btn-default" id="closeModal">취소</button>
								</div>
								<div class="col-md-6">
									<button type="button" class="btn btn-default" id="visitBooking"
										data-dismiss="modal">완료</button>
										<input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"> 
								</div>
							</div>
						</form>
					</div>
				</div>

				<div id="navbar" name="navbar" class="w3-round-large">
					<a href="#introduce" class="nb">지점 소개</a> <a href="#locationInfo"
						class="nb">위치 정보</a> <a href="#roomInfo" class="nb">방 정보</a> <a
						href="#detailInfo" class="nb">세부 정보</a> <a href="#review"
						class="nb">리뷰</a>
				</div>

				<script>
					$('a.nb').on('click', function() {
						$('a.nb').removeClass('active');
						$(this).addClass('active');
					});
				</script>

				<div id="introduce" class="w3-container">
					<br /> <br /> <br /> <br /> <br /> <br />
					<h2>지점 소개</h2>
					<br />
					<p th:text="${details.branchComment}"></p>
					<br />
					<table class="w3-table-all">
						<tr>
							<th>주소</th>
							<th>최대 거주 인원</th>
							<th>거주 유형</th>
							<th>반려동물 동반입주</th>
							<th>주차장 유무</th>
							<th>엘리베이터 유무</th>
						</tr>
						<tr>
							<td th:text="|*{details.address} *{details.addressDetail}|"
								id='branchAddress'>주소</td>
							<td th:text="${details.maximumResident}"></td>
							<td th:text="${details.branchType}"></td>
							<td th:text="${details.pet}"></td>
							<td th:text="${details.isParking}"></td>
							<td th:text="${details.isElevator}"></td>
						</tr>
						<tr>
					</table>
				</div>


				<div id="locationInfo" class="w3-container">

					<br /> <br /> <br /> <br /> <br /> <br />

					<h2>위치 정보</h2>
					<br />

					<div id="map" style="width: 700px; height: 500px;"></div>
					<br />

					<div class="container">
						<div class="row">
							<div class="col-md-4">
								<h3 id="MT1" name="mouseEvent">대형마트</h3>
							</div>
							<div class="col-md-4">
								<h3 id="CS2" name="mouseEvent">편의점</h3>
							</div>
							<div class="col-md-4">
								<h3></h3>
							</div>
						</div>

						<div class="row">
							<div class="col-md-4">
								<h3 id="PK6" name="mouseEvent">주차장</h3>
							</div>
							<div class="col-md-4">
								<h3 id="SW8" name="mouseEvent">지하철역</h3>
							</div>
							<div class="col-md-4">
								<h3></h3>
							</div>
						</div>

						<div class="row">
							<div class="col-md-4">
								<h3 id="BK9" name="mouseEvent">은행</h3>
							</div>
							<div class="col-md-4">
								<h3 id="CT1" name="mouseEvent">문화시설</h3>
							</div>
							<div class="col-md-4">
								<h3></h3>
							</div>
						</div>

						<div class="row">
							<div class="col-md-4">
								<h3 id="FD6" name="mouseEvent">음식점</h3>
							</div>
							<div class="col-md-4">
								<h3 id="CE7" name="mouseEvent">카페</h3>
							</div>
							<div class="col-md-4">
								<h3></h3>
							</div>
						</div>

						<div class="row">
							<div class="col-md-4">
								<h3 id="HP8" name="mouseEvent">병원</h3>
							</div>
							<div class="col-md-4">
								<h3 id="PM9" name="mouseEvent">약국</h3>
							</div>
							<div class="col-md-4">
								<h3></h3>
							</div>
						</div>
					</div>
				</div>


				<div id="roomInfo" class="w3-container">

					<br /> <br /> <br /> <br /> <br /> <br />

					<h2>방 정보</h2>
					<br /> <img class="img-fluid img-thumbnail"
						src="http://placehold.it/700x400" alt=""> <br /> <br /> <br />
					<table class="w3-table-all">
						<tr>
							<th>호수</th>
							<th>성별</th>
							<th>정원</th>
							<th>면적</th>
							<th>보증금</th>
							<th>월세</th>
							<th>입주가능일</th>
						</tr>
						<tr th:each="roomInfo:${roomInfoList}">
							<td th:text="${roomInfo.roomNumber}"></td>
							<td th:text="${roomInfo.gender}"></td>
							<td th:text="|*{roomInfo.allowNumber}인실|"></td>
							<td th:text="${roomInfo.space}"></td>
							<td th:text="${roomInfo.deposit}"></td>
							<td th:text="${roomInfo.monthlyRent}"></td>
							<td th:text="${roomInfo.rentableDate}"></td>
						</tr>
					</table>
				</div>


				<div id="detailInfo" class="w3-container">

					<br /> <br /> <br /> <br /> <br /> <br />

					<h2>세부 정보</h2>
					<br />

					<h3>시설 정보</h3>
					<br />

					<h4>공용 시설</h4>
					<br />
					<p th:text="${details.facility}"></p>

					<br /> <br /> <br />

					<div class="w3-container">
						<h4>개별 시설</h4>
						<br />
						<table class="w3-table-all">
							<tr>
								<th>호수</th>
								<th>시설</th>
							</tr>
							<tr th:each="roomInfo:${roomInfoList}">
								<td th:text="${roomInfo.roomNumber}"></td>
								<td th:text="${roomInfo.facility}"></td>
							</tr>
						</table>
					</div>


					<br /> <br /> <br />

					<h3>공동 생활 규칙</h3>
					<br />

					<h4>기본 생활 규칙</h4>
					<br />
					<p>모든 지점에 공통으로 적용되는 생활 규칙</p>
					<br />

					<h4 th:text="|*{details.branchNumber}호점의 생활 규칙|"></h4>
					<br />
					<p th:text="${details.rule}"></p>
					<br />

					<h3>입주민 정보</h3>
					<br />


					<table class="w3-table-all">
						<tr>
							<th>닉네임</th>
							<th>성별</th>
							<th>나이</th>
							<th>관심사</th>
							<th>소개글</th>
						</tr>
						<tr th:each="memberInfo:${memberInfoList}">
							<td th:text="${memberInfo.nickname}"></td>
							<td th:text="${memberInfo.memberGender}"></td>
							<td th:text="${memberInfo.birth}"></td>
							<td
								th:text="|*{memberInfo.favorite1}, *{memberInfo.favorite2}, *{memberInfo.favorite3}|"></td>
							<td th:text="${memberInfo.introduce}"></td>
						</tr>
					</table>

					<br /> <br /> <br />
					<h3>반려동물 정보</h3>
					<br />
					<div th:each="memberInfo:${memberInfoList}">
						<p
							th:text="|*{memberInfo.animal}, *{memberInfo.amount}마리|"></p>
					</div>
				</div>

					<br /> <br /> <br /> <br /> <br /> <br />
<!-- ★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★리뷰 ★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★★ㅍ-->
					<h2>리뷰</h2>
					<br />

				<div id="review" class="w3-container">
					<div class="row">
						<div class="form-group">
							<form name="reviewInsertForm">
								<div class="input-group">
									<input type="hidden" name="writingNumber">
									<input type="hidden" name="branchNumber" th:value="${details.branchNumber}"> 
									<input type="text" style="width: 763.5px" class="form-control" id="content" name="reviewContent" placeholder="내용을 입력하세요.">
									<span class="input-group-btn">
										<button class="btn btn-default" type="button" name="reviewInsertBtn">등록</button> 
									</span>
								</div>
							</form>

						</div>
							
						
						<div class="container">
							<div id="reviewList">
						</div>
							<!-- <input type="hidden" th:name="${_csrf.parameterName}"
									th:value="${_csrf.token}"> -->
						</div>
					</div>
				</div>
			</div>
				<div class="col-md-1">
				<div id="navbar1" class="w3-round-large">
					<br />
					<h2 th:text="|낙낙 *{details.branchNumber}호점|" style="color: #f2f2f2"></h2>
					<br />
					<button id="myBtn1" class='btn btn-default'
						onclick="location.href='/toSharingGuide'">입주 안내</button>
					<!-- <sec:authentication property="principal" var="user" /> -->	
					<button id="myBtn" class='btn btn-default'>방문 신청</button>
					<br />
				</div>
			</div>
		</div>
	
		<br /> <br /> <br />

		<!-- 리뷰 Ajax -->
		<script>
		
		<!-- 시큐리티 + 에이젝스 에러 방지 설정222 -->
		var token = $("meta[name='_csrf']").attr("content");
		var header = $("meta[name='_csrf_header']").attr("content");
		$(function() {
			$(document).ajaxSend(function(e, xhr, options) {
				xhr.setRequestHeader(header, token);
			});
		});
		
		/* var branchNumber= $("input[name='branchNumber']").val(); */

			function showReviewList(){
			var branchNumber1= $("input[name='branchNumber']").val();
			inner="";
	
			 $.ajax({
 				type:'post',  
				url:'/reviewList',
 				data: branchNumber1, // 값 하나만 받아오기
                dataType:"text", // ajax 호출후 리턴받는 결과에 대한 데이터 타입
				contentType: "application/json",
				// async:false, async는 deprecated 되었음
				 success:function(result){
					$.each(JSON.parse(result), function(key, value) {
						inner += '<div class="reviewArea" style="border-bottom:1px solid darkgray; margin-bottom: 15px;">';
						inner += '<div class="reviewInfo'+value.writingNumber+'">'
								+ '작성일자 : '
								+ value.writeTime
								+ ' / 작성자 : '
								+ value.nickname;
						inner += '&nbsp&nbsp&nbsp&nbsp<button name="aboutReview" class="btn btn-default" onclick="reviewUpdate('
								+ value.writingNumber
								+ ',\''
								+ value.content
								+ '\');"> 수정 </button>';
						inner += '&nbsp<button name="aboutReview" class="btn btn-default" onclick="deleteConfirm('
								+ value.writingNumber
								+ ');"> 삭제 </button> </div>';
						inner += '<div class="reviewContent'+value.writingNumber+'"> <p> 내용 : '
								+ value.content
								+ '</p>';
						inner += '</div></div>'; 
					});
					
					$("#reviewList").html(inner);
				},
				error:function(result){
					inner+="<br /><h3>에러 발생</h3><br />"
					$("#reviewList").html(inner);
				}
			});
		}; 
		
		// 리뷰 등록
	 	$('[name=reviewInsertBtn]').click(function() { // 리뷰 등록 버튼 클릭시 
	 		var branchNumber= $("input[name='branchNumber']").val();
	 		var content = $("input[name='reviewContent']").val();
			// var insertData = $('[name=reviewInsertForm]').serialize(); // reviewInsertForm의 내용을 가져옴
		
			$.ajax({
				url : '/reviewInsert',
				type : 'post',
				data : JSON.stringify({
						"branchNumber":branchNumber,
						"content":content
				}),
				dataType : 'text',
				contentType: "application/json",
				success : function(data) {
					if (data == 1) {
						showReviewList(); // 리뷰 작성 후 댓글 목록 reload
						$('[name=reviewContent]').val(''); 
					}
				}
			});
		})
		
		// 리뷰 수정 - 리뷰 내용 출력을 input 폼으로 변경 
		function reviewUpdate(writingNumber, content) {
			var a = '';

			a += '<div class="input-group">';
			a += '<input type="text" class="form-control" name="content_'+writingNumber+'" value="'+content+'"/>';
			a += '<span class="input-group-btn"><button class="btn btn-default" type="button" onclick="reviewUpdateProc('
					+ writingNumber + ');">수정 완료</button> </span>';
			a += '</div>';

			$('.reviewContent' + writingNumber).html(a);
		} 

	 	// 리뷰 수정
		function reviewUpdateProc(writingNumber) {
			var updateContent = $('[name=content_' + writingNumber + ']').val();

			$.ajax({
				url : '/reviewUpdateProc',
				type : 'post',
				data : JSON.stringify({
					'content' : updateContent,
					'writingNumber' : writingNumber
				}),
				dataType : 'text',
				contentType: "application/json",
				success : function(data) {
					if (data == 1)
						showReviewList(branchNumber); //댓글 수정후 목록 출력 
				}
			});
		}

		// 리뷰 삭제 
		function deleteConfirm(writingNumber){
			var msg = confirm("리뷰를 삭제하시겠습니까?");
			if(msg==true){ // 확인 버튼 클릭 시
				reviewDelete(writingNumber);
			} else { // 취소 버튼 클릭 시
				return false;
			}
		}
		
		function reviewDelete(writingNumber) {
			$.ajax({
				url : '/reviewDelete'+writingNumber,
				type : 'post',
				data : writingNumber,
				dataType : 'text',
				success : function(data) {
					if (data == 1)
						showReviewList(branchNumber); //댓글 삭제 후 목록 출력 
				}
			});
		} 
		
		$(document).ready(function() {
			showReviewList(); //페이지 로딩시 리뷰 목록 출력 
		}); 
		
		</script>

		<!-- 방문신청 모달 -->
		<script>
			// Get the modal
			var modal = document.getElementById('myModal');

			// Get the button that opens the modal
			var btn = document.getElementById("myBtn");

			// Get the <span> element that closes the modal
			var span = document.getElementsByClassName("close")[0];
			
			var closeModal = document.getElementById("closeModal");
			var visitBooking = document.getElementById("visitBooking");
			
			// When the user clicks the button, open the modal 
			btn.onclick = function() {
				modal.style.display = "block";
			}

			// When the user clicks on <span> (x), close the modal
			span.onclick = function() {
				modal.style.display = "none";
			}

			// When the user clicks anywhere outside of the modal, close it
			window.onclick = function(event) {
				if (event.target == modal) {
					modal.style.display = "none";
				}
			}
		
			closeModal.onclick = function(){
				modal.style.display = "none";
			}
			
	 		visitBooking.onclick = function(){
	 			
	 			
	 			
	 			
	 			
				branchNumber= $("input[name='branchNumber']").val();
				reservationTime = $("input[name='reservationTime']").val();
				memo = $("input[name='memo']").val();
				
				// var ss = $("#visitBookingForm").serialize();
				 inner ="";
				
				$.ajax({
					method:'post',
					url: '/visitBooking',
					data:
						JSON.stringify({ // form에서 받아온 값들을 json 형식의 데이터로 처리
						"branchNumber":branchNumber,
						"reservationTime":reservationTime,
						"memo":memo 
					}),
					dataType: "text", // 리턴 타입이 void일 경우에는 "json"이 아니라 "text"로
					contentType:"application/json", // 정확한 이유는 모르겠으나 이거 없으면 415 에러 발생
					success:function(data){
						inner+="<div class='modal-content'><span id='modalx' class='close'>&times;</span><br /><h3>방문 신청이 완료되었습니다</h3><br /></div>"
						$("#myModal").html(inner);
					},
					error:function(data){  
						inner+="<div class='modal-content'><span id='modalx' class='close'>&times;</span><br /><h3>에러 발생</h3><br /></div>"
						$("#myModal").html(inner);
					}
				});
			};
			
			// 동적으로 생성된 태그에 이벤트 걸기
			$(document).on("click", "#modalx", function(){
				modal.style.display = "none";
			});
		</script>

		<!-- 셰어 하우스 위치 표시, 카테고리별 위치 정보 표시 -->
		<script type="text/javascript"
			src="//dapi.kakao.com/v2/maps/sdk.js?appkey=b497e483355c4a6cc558f83dcd637541&libraries=services"></script>

		<script>
		
			var markers = [];		
		
			var mapContainer = document.getElementById('map'), // 지도를 표시할 div 
			
			mapOption = {
				center : new daum.maps.LatLng(33.450701, 126.570667), // 지도의 중심좌표
			// 지도의 확대 레벨
				level : 3
			};

			// 지도를 생성합니다    
			var map = new daum.maps.Map(mapContainer, mapOption);

			// 주소-좌표 변환 객체를 생성합니다
			var geocoder = new daum.maps.services.Geocoder();
			
			// 태그에 들어 있던 지점 주소를 가지고 와서 변수에 담는다
			var branchAddress = document.getElementById("branchAddress");
			
			// 리터럴로 치환한 th의 text값도 문제 없이 넣을 수 있다
			var branchNumber = document.getElementById("branchNumber");
			// var branchNameTest = document.getElementById("branchNameTest");
			
			// 주소로 좌표를 검색합니다
			geocoder.addressSearch(branchAddress.textContent, function(result, status) {

								// 정상적으로 검색이 완료됐으면 
								if (status === daum.maps.services.Status.OK) {

									var coords = new daum.maps.LatLng(
											result[0].y, result[0].x);

									// 결과값으로 받은 위치를 마커로 표시합니다
									var marker = new daum.maps.Marker({
										map : map,
										position : coords
									});

									// 인포윈도우에 표출될 내용으로 HTML 문자열이나 document element 삽입 가능
									var customContent = '<div style="width:150px;text-align:center;padding:6px 0;">낙낙 '+branchNumber.textContent+'호점</div>';
									
									// 인포윈도우로 장소에 대한 설명을 표시합니다
									var infowindow = new daum.maps.InfoWindow(
											{
												content : customContent
											});
											infowindow.open(map, marker);

									// 지도의 중심을 결과값으로 받은 위치로 이동시킵니다
									map.setCenter(coords);
								}
							});
			
			// 마우스 클릭 이벤트가 발생할 요소 선택
			var MT1 = document.getElementById("MT1");
			var CS2 = document.getElementById("CS2");
			var PK6 = document.getElementById("PK6");
			var SW8 = document.getElementById("SW8");
			var BK9 = document.getElementById("BK9");
			var CT1 = document.getElementById("CT1");
			var FD6 = document.getElementById("FD6");
			var CE7 = document.getElementById("CE7"); 
			var HP8 = document.getElementById("HP8");
			var PM9 = document.getElementById("PM9");
			
				// 마커를 클릭하면 장소명을 표출할 인포윈도우 입니다
				var infowindow1 = new daum.maps.InfoWindow({zIndex:1});
			
				// 장소 검색 객체를 생성합니다
				var ps = new daum.maps.services.Places(map);

				// 키워드 검색 완료 시 호출되는 콜백함수 입니다
				function placesSearchCB (data, status, pagination) {
					if (status === daum.maps.services.Status.OK) {
				        for (var i=0; i<data.length; i++) {
				            displayMarker(data[i]);    
				        }       
				    }
				}
				
				// 지도에 마커를 표시하는 함수입니다
				function displayMarker(place) {
				    // console.log(place);

				    // 마커를 생성하고 지도에 표시합니다
				    var marker1 = new daum.maps.Marker({
				        map: map,
				        position: new daum.maps.LatLng(place.y, place.x) 
				    });
			
				    // 생성된 마커를 배열에 담는다
				    markers.push(marker1);
		
			// 마커에 마우스 오버 이벤트를 등록합니다
				daum.maps.event
						.addListener(
								marker1,
								'mouseover',
								function() {
									// 마커에 마우스 오버 하면 장소명이 인포윈도우에 표출됩니다
									infowindow1
											.setContent('<div style="padding:5px;font-size:12px;">'
													+ place.place_name
													+ '</div>');
									infowindow1.open(map, marker1);
								});

				// 마커에 마우스아웃 이벤트를 등록합니다
				daum.maps.event.addListener(marker1, 'mouseout', function() {
					// 마커에 마우스아웃 이벤트가 발생하면 인포윈도우를 제거합니다
					infowindow1.close();
				});
			}
				
				// 이전 마커 지우기
				function hideMarkers(){
				for (var i = 0; i < markers.length; i++) {
					markers[i].setMap(null);
				}
				}

			MT1.addEventListener('click', function() {

				hideMarkers();

				//카테고리로 대형마트를 검색
				ps.categorySearch('MT1', placesSearchCB, {
					useMapBounds : true
				});

			});

			CS2.addEventListener('click', function() {

				hideMarkers();
				
				//카테고리로 대형마트를 검색
				ps.categorySearch('CS2', placesSearchCB, {
					useMapBounds : true
				});

			});

			PK6.addEventListener('click', function() {

				hideMarkers();
				
				//카테고리로 대형마트를 검색
				ps.categorySearch('PK6', placesSearchCB, {
					useMapBounds : true
				});

			});

			SW8.addEventListener('click', function() {

				hideMarkers();
				
				//카테고리로 대형마트를 검색
				ps.categorySearch('SW8', placesSearchCB, {
					useMapBounds : true
				});

			});

			BK9.addEventListener('click', function() {

				hideMarkers();
				
				//카테고리로 대형마트를 검색
				ps.categorySearch('BK9', placesSearchCB, {
					useMapBounds : true
				});

			});

			CT1.addEventListener('click', function() {

				hideMarkers();
				
				//카테고리로 대형마트를 검색
				ps.categorySearch('CT1', placesSearchCB, {
					useMapBounds : true
				});

			});

			FD6.addEventListener('click', function() {

				hideMarkers();
				
				//카테고리로 대형마트를 검색
				ps.categorySearch('FD6', placesSearchCB, {
					useMapBounds : true
				});

			});

			CE7.addEventListener('click', function() {
				
				hideMarkers();
				
				//카테고리로 대형마트를 검색
				ps.categorySearch('CE7', placesSearchCB, {
					useMapBounds : true
				});

			});

			HP8.addEventListener('click', function() {

				hideMarkers();
				
				//카테고리로 대형마트를 검색
				ps.categorySearch('HP8', placesSearchCB, {
					useMapBounds : true
				});

			});

			PM9.addEventListener('click', function() {

				hideMarkers();
				
				//카테고리로 대형마트를 검색
				ps.categorySearch('PM9', placesSearchCB, {
					useMapBounds : true
				});

			});
		</script>

		<!-- 스티키 내비게이션 바 -->
		<script>
			window.onscroll = function() {
				myFunction()
			};

			var navbar = document.getElementById("navbar");
			var navbar1 = document.getElementById("navbar1");
			// var sticky = navbar.offsetTop; // 92

			function myFunction() {
				if (window.pageYOffset >= 792.799) { 
					navbar.classList.add("sticky")
					navbar1.classList.add("sticky1")
				} else {
					navbar.classList.remove("sticky");
					navbar1.classList.remove("sticky1");
				}
			}
		</script>
		
		<!-- 						<div class="col-md-4">
							<div class="form-group">
									<div class='uploadResult'>
										<ul>
										</ul>
									</div> 
								<p class="help-block">업로드 할 대표 사진 한 장을 선택해주세요.</p>
									<div class='uploadDiv'>
										<input type='file' name='uploadFile'>
									</div>
									<input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
									<button id='uploadBtn'>Upload</button>
							</div>
						</div>
						<div class="col-md-8"> -->
		
	<!-- 		<script>
			$(document).ready(function(){
				
				var regex = new RegExp("(.*?)\.(exe|sh|zip|alz)$");
				var maxSize = 5242880; // 5MB
				
				// 파일 크기, 확장자 제한
				function checkExtension(fileName, fileSize){
					
					if(fileSize >= maxSize){
						alert("파일 크기 초과");
						return false;
					}
					
					if(regex.test(fileName)){
						alert("해당 종류의 파일은 업로드할 수 없습니다.");
						return false;
					}
					return true;
				}
				
				// 파일 업로드 폼 복사
				var cloneObj = $(".uploadDiv").clone();
				
				// 파일 목록
 				var uploadResult = $(".uploadResult ul");
				
				// 파일 삭제
				$(".uploadResult").on("click", "span", function(e){
					
					var targetFile = $(this).data("file");
					var type = $(this).data("type");
					console.log(targetFile);
					
					$.ajax({
						url: '/deleteFile',
						data: {fileName: targetFile, type:type},
						dataType: 'text',
						type: 'POST',
						success: function(result){
							alert(result);
						}
					});
				});
				
				function showUploadedFile(uploadResultArr){
					var str="";
					
					$(uploadResultArr).each(function(i, obj){
					
						var fileCallPath = encodeURIComponent("/"+obj.uploadPath+"/"+
								obj.uuid+"_"+obj.fileName);
						
						var originPath = obj.uploadPath +"\\"+obj.uuid+"_"+obj.fileName;
						originPath = originPath.replace(new RegExp(/\\/g), "/"); 
						
						 str += "<li><img src='/display?fileName="+fileCallPath+"'><span data-file=\'"+fileCallPath+"\' data-type='image'>x</span></li>"; 
						
					});
					
					uploadResult.append(str);
					alert("이미지 가져오기");
				} 
				
				$("#uploadBtn").on("click", function(e){
					var formData=new FormData();
					var inputFile =$("input[name='uploadFile']");
					var files = inputFile[0].files;
					console.log(files);
					
					//add filedata to formdata
					for(var i=0; i<files.length; i++){
						
						if(!checkExtension(files[i].name, files[i].size)){
							return false;
						}
						
						formData.append("uploadFile", files[i]);
					}
					
					$.ajax({
						url: '/uploadAjaxAction',
						processData:false,
						contentType:false,
						data: formData,
						type: 'POST',
						dataType: 'json',
						success: function(result){
							
							alert("uploaded!");
							console.log(result);
							
							showUploadedFile(result);
							
							// 복사해두었던 폼 다시 생성
							$(".uploadDiv").html(cloneObj.html());
						}
					});
				});
			});
		</script> -->
</div>
</body>
</html>