<!DOCTYPE html>
<html xmlns:layout="http://www.w3.org/1999/xhtml" 
layout:decorate="~{etc/fragments/Main_layout}">
<head>
<meta charset="UTF-8">
<meta id="_csrf" name="_csrf" th:content="${_csrf.token}"/>
<meta id="_csrf_header" name="_csrf_header" th:content="${_csrf.headerName}"/>
<title>모임 만들기</title>
<style type="text/css">
#jumbotronId{
    background-color: white;
}
.btn-file {
    position: relative;
    overflow: hidden;
}
</style>
</head>
<body>

	<div layout:fragment="content" class="container">
		<div class="jumbotron" id="jumbotronId">
			<h3>모임 개설하기</h3>
			<form action="/writeBoard" role="form" id="editorForm" enctype="multipart/form-data">
				<div class="row">
					<div class="col-2">
						<span>대표이미지</span>
						<img class="d-block" width="150" height="150" id="foo" src="#" onerror="this.src='https://brienshamp.com/images/default-image.jpg';"/>
						<input class="form-control-file" type='file' name="image" id="imgInp"/>
						<small>* 이미지 등록에 대한 안내는 FAQ를 확인해주세요</small>
					</div>
					<div class="col">
						<table class="table">
							<tr>
								<td>작성자</td>
								<td><input type="number" name="memberNumber" required></td>
							</tr>
							<tr>
								<td>모임명<small class="text-danger">(필수)</small></td>
								<td><input type="text" name="title" maxlength="30" required></td>
							</tr>
							<tr>
								<td>모임테마</td>
								<td>
									<select name=favorite>
										<option value="없음">없음</option>
										<option value="IT">IT</option>
										<option value="컴퓨터">컴퓨터</option>
										<option value="음악">음악</option>
										<option value="요리">요리</option>
										<option value="제과/제빵">제과/제빵</option>
										<option value="공연">공연</option>
										<option value="커피">커피</option>
										<option value="전시">전시</option>
										<option value="드로잉">드로잉</option>
										<option value="영화">영화</option>
										<option value="어학">어학</option>
										<option value="패션">패션</option>
										<option value="운동">운동</option>
										<option value="게임">게임</option>
										<option value="사진">사진</option>
										<option value="댄스">댄스</option>
										<option value="자동차">자동차</option>
										<option value="독서">독서</option>
										<option value="여행">여행</option>
										<option value="와인">와인</option>
										<option value="낚시">낚시</option>
										<option value="인문학">인문학</option>
										<option value="천문학">천문학</option>
										<option value="꽃꽃이">꽃꽂이</option>
										<option value="가드닝">가드닝</option>
										<option value="캘리그라피">캘리그라피</option>
										<option value="스터디">스터디</option>
									</select>
								</td>
							</tr>
							<tr>
								<td>모임기간<small class="text-danger">(필수)</small></td>
								<td><input type="date" name="meetingStartTime" required>부터
								<input type="date" name="meetingEndTime" required>까지</td>
							</tr>
							<tr>
								<td>접수기간<small class="text-danger">(필수)</small></td>
								<td><input type="date" name="acceptStartTime" required>부터
								<input type="date" name="acceptEndTime" required>까지</td>
							</tr>
							<tr>
								<td>모임장소<small class="text-danger">(필수)</small></td>
								<td><input type="text" name="place" placeholder="장소명, 주소를 입력해주세요." required>
								<input th:type="text" name="placeDetail" placeholder="나머지 주소를 입력하세요." ></td>
							</tr>
							<tr>
								<td>모집인원<small class="text-danger">(필수)</small></td>
								<td><input type="number" name="recruitMaxNumber" required>명</td>
							</tr>
							<tr>
								<td>성별</td>
								<td>
									<select name="gender">
										<option value="무관">무관</option>
										<option value="남자만">남자만</option>
										<option value="여자만">여자만</option>
									</select>
								</td>
							</tr>
							<tr>
								<td>모임소개<small class="text-danger">(필수)</small></td>
								<td><textarea name="detailIntroduce" id="ckeditor" maxlength="3000" required></textarea></td>
							</tr>
						</table>
						<input class="pull-right" type="submit" value="개설완료">
					</div>
				</div>
			</form>
		</div>
<!-- 	<script type="text/javascript" src="/ckeditor/ckeditor.js"></script> -->

		<script type="text/javascript">
// 		var token = $("meta[name='_csrf']").attr("content");
// 		var header = $("meta[name='_csrf_header']").attr("content");
// 		$(function() {
// 		    $(document).ajaxSend(function(e, xhr, options) {
// 		        xhr.setRequestHeader(header, token);
// 		    });
// 		});
        function readURL(input) {
            if (input.files && input.files[0]) {
              var reader = new FileReader();
              reader.onload = function(e) {
                $('#foo').attr('src', e.target.result);
              }
              reader.readAsDataURL(input.files[0]);
            }
          }
          $("#imgInp").change(function() {
            readURL(this);
          });
		//사진 미리보기
// 		function readURL(input){
// 			if(input.files && input.files[0]){
// 				var reader = new FileReader();
			
// 				reader.onload = function(e){
// 					$("#img").attr('src',e.target.result);
// 				}
// 				reader.readAsDataURL(input.files[0]);
// 			}
// 		}
// 		$("#uploadProfileShot").change(function(){
// 			readURL(this);
// 		})
		
		//사진 업데이트
// 		function uploadProfileShot(){
// 			var formData = new FormData();
// 			var inputFile = $("input[name='uploadFileShot']");
// 			var files = inputFile[0].files;
			
// 			for(var i=0; i<files.length; i++){
// 				formData.append("uploadFile",files[i]); //uploadFile은 컨트롤러 MultipartFile의 변수명
// 			}	
		
// 			$.ajax({
// 				type:'post',
// 				url:'/profileUpdate',
// 				data:formData,
// 				processData:false,
// 				contentType:false,
// 				dataType:'json',
// 				success:function(result){
// 					alert("업로드완료");
// 				},
// 				error:function(error){
// 					location.reload();
// 					alert("업로드실패");
					
// 				}
// 			});
// 		}

		</script>
		<script th:src="@{/ckeditor/ckeditor.js}"></script>
		<script>
		    $(function(){
		        CKEDITOR.replace( 'ckeditor', {//해당 이름으로 된 textarea에 에디터를 적용
		            width:'100%',
		            height:'400px',
		            //filebrowserImageUploadUrl: '/imageUpload' //여기 경로로 파일을 전달하여 업로드 시킨다.
		        });
	
		        CKEDITOR.on('dialogDefinition', function( ev ){
		            var dialogName = ev.data.name;
		            var dialogDefinition = ev.data.definition;
		          
		            switch (dialogName) {
		                case 'image': //Image Properties dialog
		                    //dialogDefinition.removeContents('info');
		                    dialogDefinition.removeContents('advanced');
		                    dialogDefinition.removeContents('Link');
		                    break;
		            }
		        });
		    });
		</script>
	</div>
</body>
</html>