<!DOCTYPE HTML>
<html xmlns:layout="http://www.w3.org/1999/xhtml" 
layout:decorate="~{etc/fragments/Main_layout}">
<head>
    <title>내 이벤트 리스트</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<!-- <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css"> -->
<style>
body {
  font-family: "Lato", sans-serif;
}

.sidenav {
  width: 200px;
  position: fixed;
  z-index: 1;
  top: 130px;
  left: 60px;
  background: #eee;
  overflow-x: hidden;
  padding: 8px 0;
  margin-right: 40px;
}

.sidenav a {
  padding: 10px 10px 10px 16px;
  text-decoration: none;
  font-size: 30px;
  color: #2eca6a;
  display: block;
}

.sidenav a:hover {
  color: #064579;
}

.main {
  margin-left: 90px; /* Same width as the sidebar + left position in px */
  padding: 0px 10px;
}

@media screen and (max-height: 450px) {
  .sidenav {padding-top: 15px;}
  .sidenav a {font-size: 30px;}
}

#sidenav{
	background-color:white;
	border: 1px solid #2eca6a;
	color:#2eca6a;
	font-weight:bolder;
	border-radius: 1rem;

}

#title{
	color:#2eca6a;
	font-size:larger;
	font-weight:bolder;
	margin-left:20%;
}

#MyEventList{
	font-family: 'Jua', sans-serif;
}
</style>
</head>
<body>
<div layout:fragment="content" class="container" id='MyEventList'>
<br /><br /><br /> <br /> 

<div class="row" id='categoryBar'>
			<div class="col-md-11">
<div class="sidenav" id='sidenav'>
  <a th:href="@{/profileMain}">내 프로필</a><br>
  <a th:href="@{/MyMeetingList}">내 모임</a><br>
  <a th:href="@{/MyEventList}">내 이벤트</a><br>
  <a th:href="@{/MyVisitList}">내 방문신청</a><br>
</div>
</div>
<div class="col-md-1">
</div>
</div>

<div class="main">
<div id="Join" class="tabcontent">
				<h3 class="font-weight-bold" id='title'>참가한 이벤트</h3>
				<br />
				<div class="w3-container">
					<table class="table table-striped">
						<tr>
							<th><input type='checkbox' id='checkAll' /></th>
							<th>제목</th>
							<th>신청 마감일</th>
							<th>이벤트 시작일</th>
							<th>이벤트 종료일</th>
							<th></th>
						</tr>
						<tr th:each="MEL:${MEL}">
							<td><input type='checkbox' name='checkRow' /></td>
							<input type='hidden' name="checkNumber" th:value="${MEL.writingNumber}"/>
							<td><a th:href="@{'/eventView/?writingNumber='+${MEL.writingNumber}}" th:text="${MEL.title}"></a></td>
							<td th:text="${MEL.acceptEndTime}"></td>
							<td th:text="${MEL.eventStartTime}"></td>
							<td th:text="${MEL.eventEndTime}"></td>
							<td><a role="button" class="btn btn-default" th:href="@{'/deleteJE/?writingNumber='+${MEL.writingNumber}}">참가 취소</a></td>
							<input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
						</tr>
					</table>
					<h4>선택된 이벤트&nbsp;<button id="checkedDelete" class="btn btn-default">참가 취소</button></h4>
				</div>
				<br />
			</div>
			


</div>  
				<script>
			$(document).ready(function(){
				
				$("#checkAll").click(function(){
					if($("#checkAll").prop("checked")){
				        $("input[name=checkRow]").prop("checked", true);
					} else {
				        $("input[name=checkRow]").prop("checked", false);

					}
				})
				
				function checkedDeleteJE(writingNumber){
					
				}
				
			 $('#checkedDelete').click(function(){
		        if(confirm("선택된 이벤트 참가를 취소하시겠습니까?")){
		        	
		        	  $("input[name=checkRow]:checked").each(function(i){
						var writingNumber1 = $("input[name=checkNumber]").eq(i).val();

					 	 console.log(writingNumber1);
						
						$.ajax({
							type:'post',  
							url:'/checkedDeleteJE',
			 				data: writingNumber1, // 값 하나만 받아오기
			                dataType:"text", // ajax 호출후 리턴받는 결과에 대한 데이터 타입
							contentType: "application/json",
							// async:false, async는 deprecated 되었음
							 success:function(response){
					            alert("이벤트 참가가 취소되었습니다.");
							 },
							 error:function(response){
								 alert("에러 발생");
							 }
						}) 
				}) 
		        	}else{
		            	return false;
		        	}
		   		}) // 끝
				
				
			})	
			
			 /* if("$(input[name=checkRow]:checked)"){
				 
					 $("input[name=checkRow]:checked").each(function(i){
						var writingNumber1 = $("input[name=checkNumber]").eq(i).prop("value");

					 	 alert(writingNumber1);
			 }
			 } */
			
	
			</script>
</div>
</body>
</html>


